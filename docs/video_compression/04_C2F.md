# Coarse-to-fine Deep Video Coding with Hyperprior-guided Mode Prediction

## Key Points

mode prediction technique

mode prodiction networks by  using hyperprior information (i.e., the mean and variance values) from the hyperprior networks contains **discriminant statistical information** of different patches

skip residual information from each block

coase-to-fine strategy: 

optical flow estimation: pyramid structure

video super-resolution: coarse-to-fine alignment strategy

gumbel softmax layer: ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒ

## Framework

![Untitled](04_C2F/01.png)

![Untitled](04_C2F/02.png)

![Untitled](04_C2F/03.png)

$F_{t-1}^{ref}$å’Œ$F_t$ä¸‹é‡‡æ ·åè¿›è¡Œç²—ç²’åº¦çš„Motion Estimation, Motion Compressionå†ä¸Šé‡‡æ ·å¾—åˆ°ç²—ç²’åº¦çš„offset mapåï¼Œå¯¹$F_{t-1}^{ref}$è¿›è¡ŒMotion Compensationï¼Œå¾—åˆ°Coarse-level Motion Compensation Branchç»“æœ$\tilde F_t$ã€‚å°†$F_t$å’Œ$\tilde F_t$è¿›è¡Œç»†ç²’åº¦çš„Motion Estimation, Motion Compression,Motion Compensationï¼Œå¾—åˆ°æœ€ç»ˆçš„$\bar F_t$ã€‚ä»¥ä¸Šçš„ç½‘ç»œç»“æœåŸºæœ¬å‚è€ƒFVCçš„è®¾è®¡ã€‚

![Untitled](04_C2F/04.png)

é€šè¿‡Mode Predictionè·å¾—Latent Presentationçš„åŒºåŸŸæ± åŒ–åˆå¹¶æ–¹æ¡ˆï¼Œå’Œæ®‹å·®å—å¿½ç•¥æ–¹æ¡ˆï¼Œè¿›ä¸€æ­¥èŠ‚çº¦å¸¦å®½

The **max operation is undifferentiable**, so the whole network cannot be end-to-end optimized through back-propagation. To address this issue, during the training process, we adopt the **Gumbel softmax strategy** to decide the optimal mode as this Gumbel softmax module is differentiable, which thus enables end-to-end optimization for the whole network.

Our proposed HAMC method can automatically **select large block sizes in smooth areas with less significant motion patterns** for bit-rate saving and use small block sizes for areas around moving object boundaries for achieving more accurate motion compensation results.

### Bit estimation network

<aside>
ğŸ’¡ David Minnen, Johannes Balle, and George D Toderic, Joint autoregressive and hierarchical priors for learned image compression, In Advances in Neural Information Processing Systems, pages 10771â€“10780, 2018.

</aside>

Without using the time-consuming auto-regressive model to estimate the bits for compressing

### Simple bit-estimation network

<aside>
ğŸ’¡ Johannes Balle, Valero Laparra, and Eero P Simoncelli, Endto-end optimized image compression, International Conference on Learning Representations (ICLR), 2017

</aside>

## Related work å‰ç½®å·¥ä½œ

FVC: A new framework towards deep video compression in feature space

Improving deep video compression by resolution-adaptive flow coding